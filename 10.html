<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chapitre 10 : Fiabilit√© & Disponibilit√© (Ing√©nierie)</title>
    
    <!-- MathJax Configuration for Single Dollar Signs -->
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']],
                processEscapes: true
            },
            svg: {
                fontCache: 'global'
            }
        };
    </script>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    <style>
        :root {
            --primary: #0056b3;
            --secondary: #6c757d;
            --success: #28a745;
            --warning: #ffc107;
            --danger: #dc3545;
            --light: #f8f9fa;
            --dark: #343a40;
            --info: #17a2b8;
        }

        body {
            font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #f4f6f9;
            margin: 0;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        h1, h2, h3 {
            color: var(--dark);
            margin-top: 1.5em;
        }

        h1 {
            text-align: center;
            color: var(--primary);
            border-bottom: 3px solid var(--primary);
            padding-bottom: 10px;
        }

        h2 {
            border-left: 5px solid var(--primary);
            padding-left: 15px;
            background: #e9ecef;
            padding-top: 10px;
            padding-bottom: 10px;
        }

        /* Pedagogical Boxes */
        .box {
            padding: 15px;
            margin: 20px 0;
            border-radius: 5px;
            border-left: 5px solid;
        }

        .definition {
            background-color: #e7f5ff;
            border-color: var(--primary);
        }
        .definition::before { content: "üìò D√©finition : "; font-weight: bold; color: var(--primary); }

        .pro-tip {
            background-color: #d4edda;
            border-color: var(--success);
        }
        .pro-tip::before { content: "üí° Astuce Pro : "; font-weight: bold; color: var(--success); }

        .vigilance {
            background-color: #fff3cd;
            border-color: var(--warning);
        }
        .vigilance::before { content: "‚ö†Ô∏è Zone de Vigilance : "; font-weight: bold; color: #856404; }

        /* Graph Containers */
        .graph-container {
            text-align: center;
            margin: 20px 0;
            padding: 10px;
            border: 1px dashed #ccc;
            background: #fff;
            min-height: 150px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        /* Interactive Exercises */
        .exercise {
            background-color: #f8f9fa;
            border: 1px solid #ddd;
            padding: 20px;
            border-radius: 8px;
            margin-top: 30px;
        }

        .exercise-btn {
            background-color: var(--primary);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            margin-top: 10px;
            transition: background 0.3s;
        }

        .exercise-btn:hover { background-color: #004494; }

        .solution {
            display: none;
            margin-top: 15px;
            padding: 15px;
            background-color: white;
            border-left: 3px solid var(--success);
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }

        /* Tables */
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        th, td {
            padding: 12px;
            border: 1px solid #ddd;
            text-align: left;
        }
        th {
            background-color: var(--primary);
            color: white;
        }
        tr:nth-child(even) { background-color: #f2f2f2; }

    </style>
</head>
<body>

<div class="container">

    <h1>Chapitre 10 : Fiabilit√© et Disponibilit√©</h1>
    <p>
        Ce module interactif explore l'application des cha√Ænes de Markov (CTMC) pour mod√©liser la disponibilit√© de syst√®mes industriels. 
        Nous nous concentrerons sur l'impact de l'architecture (S√©rie vs Parall√®le) et des ressources de maintenance (1 vs 2 r√©parateurs).
    </p>

    <!-- ================= SECTION 1 ================= -->
    <h2>1. Syst√®me √† 2 Composants et 2 R√©parateurs</h2>

    <div class="definition">
        <p>Un syst√®me <strong>r√©parable</strong> oscille entre fonctionnement et panne. Ici, nous √©tudions deux composants identiques avec :</p>
        <ul>
            <li>Taux de d√©faillance : $\lambda$ (par composant)</li>
            <li>Taux de r√©paration : $\mu$ (par r√©parateur)</li>
        </ul>
    </div>

    <h3>1.1. Mod√©lisation Graphique</h3>
    <p>
        L'espace d'√©tats est d√©fini par le nombre de composants en panne $k \in \{0, 1, 2\}$.
        Puisqu'il y a 2 r√©parateurs, si 2 machines sont en panne, elles sont r√©par√©es simultan√©ment.
    </p>

    <!-- GRAPH CONTAINER FOR 2 REPAIRMEN -->
    <div class="graph-container" id="graph-2rep">
        <em>G√©n√©ration du diagramme en cours...</em>
    </div>
    <!-- Hidden code source for the graph -->
    <script type="text/plain" id="code-2rep">
digraph G {
    rankdir=LR;
    bgcolor="transparent";
    node [style=filled, fillcolor="#e6f3ff", fontname="Arial", shape=circle, fixedsize=true, width=1.2];
    edge [fontname="Arial", fontsize=12];

    0 [label="√âtat 0\n(2 UP)"];
    1 [label="√âtat 1\n(1 UP)"];
    2 [label="√âtat 2\n(2 DOWN)"];

    0 -> 1 [label="2Œª", color="#d62728", fontcolor="#d62728"];
    1 -> 0 [label="Œº", color="#2ca02c", fontcolor="#2ca02c"];
    1 -> 2 [label="Œª", color="#d62728", fontcolor="#d62728"];
    2 -> 1 [label="2Œº", color="#2ca02c", fontcolor="#2ca02c", penwidth=2];
}
    </script>

    <div class="vigilance">
        <p><strong>Pourquoi le retour de 2 √† 1 est-il √† un taux $2\mu$ ?</strong></p>
        <p>Deux r√©parateurs travaillent ind√©pendamment. Le temps pour sortir de l'√©tat 2 est le minimum de deux variables exponentielles $Exp(\mu)$. La loi du minimum est $Exp(\mu + \mu) = Exp(2\mu)$.</p>
    </div>

    <h3>1.2. Solution Math√©matique</h3>
    <p>En r√©solvant les √©quations d'√©quilibre (voir section exercices pour le d√©tail), nous obtenons la distribution stationnaire :</p>
    
    $$ \pi_0 = \frac{1}{(1 + \frac{\lambda}{\mu})^2}, \quad \pi_1 = \frac{2\lambda\mu}{(\lambda+\mu)^2}, \quad \pi_2 = \frac{\lambda^2}{(\lambda+\mu)^2} $$

    <!-- MINI EXERCISE 1 -->
    <div class="exercise">
        <h4>‚ö° Mini-Exercice 1 : Compr√©hension des flux</h4>
        <p>Supposons que $\lambda = 1$ panne/h et $\mu = 10$ r√©parations/h. Quelle est la probabilit√© approximative que le syst√®me soit totalement √† l'arr√™t (√âtat 2) ?</p>
        
        <button class="exercise-btn" onclick="toggleSolution('sol-1')">Voir la r√©ponse</button>
        
        <div id="sol-1" class="solution">
            <p>Calculons le ratio $\rho = \frac{\lambda}{\mu} = \frac{1}{10} = 0.1$.</p>
            <p>La formule pour $\pi_2$ est :
            $$ \pi_2 = \frac{\lambda^2}{(\lambda+\mu)^2} = \left( \frac{1}{1+10} \right)^2 = \left( \frac{1}{11} \right)^2 \approx 0.0082 $$
            </p>
            <p><strong>Interpr√©tation :</strong> Le syst√®me est totalement en panne moins de 1% du temps gr√¢ce √† la r√©paration rapide et double.</p>
        </div>
    </div>

    <hr>

    <!-- ================= SECTION 2 ================= -->
    <h2>2. Syst√®me avec 1 Seul R√©parateur</h2>

    <p>
        Si nous r√©duisons le budget maintenance, un seul technicien doit r√©parer les machines. Si les deux tombent en panne, la deuxi√®me doit <strong>attendre</strong> que la premi√®re soit r√©par√©e.
    </p>

    <!-- GRAPH CONTAINER FOR 1 REPAIRMAN -->
    <div class="graph-container" id="graph-1rep">
        <em>G√©n√©ration du diagramme en cours...</em>
    </div>
    <script type="text/plain" id="code-1rep">
digraph G {
    rankdir=LR;
    bgcolor="transparent";
    node [style=filled, fillcolor="#fff2cc", fontname="Arial", shape=circle, fixedsize=true, width=1.2];
    edge [fontname="Arial", fontsize=12];

    0 [label="√âtat 0\n(2 UP)"];
    1 [label="√âtat 1\n(1 UP)"];
    2 [label="√âtat 2\n(2 DOWN)"];

    0 -> 1 [label="2Œª", color="#d62728"];
    1 -> 0 [label="Œº", color="#2ca02c"];
    1 -> 2 [label="Œª", color="#d62728"];
    2 -> 1 [label="Œº", color="#2ca02c", penwidth=3, style="dashed"];
    
    labelloc="b";
    label="Notez le changement : Taux = Œº (File d'attente)";
}
    </script>

    <div class="pro-tip">
        <p>Le taux de transition $2 \to 1$ devient $\mu$ (au lieu de $2\mu$). C'est le <strong>goulot d'√©tranglement</strong> du syst√®me.</p>
    </div>

    <h3>2.2. Solution Math√©matique</h3>
    <p>La distribution change car l'√©quilibre $1 \leftrightarrow 2$ devient $\lambda \pi_1 = \mu \pi_2$.</p>
    
    $$ \pi_0 = \frac{1}{1 + 2(\frac{\lambda}{\mu}) + 2(\frac{\lambda}{\mu})^2} $$
    $$ \pi_2 = 2 \left( \frac{\lambda}{\mu} \right)^2 \pi_0 $$

    <!-- ================= SECTION 3 ================= -->
    <h2>3. Calcul de la Disponibilit√© (S√©rie vs Parall√®le)</h2>

    <p>Une fois les $\pi_k$ calcul√©s, la disponibilit√© $A$ d√©pend de l'architecture logique.</p>

    <table>
        <thead>
            <tr>
                <th>Architecture</th>
                <th>Logique de Fonctionnement</th>
                <th>√âtats Fonctionnels (UP)</th>
                <th>Formule Disponibilit√© ($A$)</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td><strong>S√©rie</strong></td>
                <td>Tout doit marcher</td>
                <td>√âtat 0 uniquement</td>
                <td>$A_{s√©rie} = \pi_0$</td>
            </tr>
            <tr>
                <td><strong>Parall√®le</strong> (Redondance)</td>
                <td>Au moins 1 marche</td>
                <td>√âtat 0 + √âtat 1</td>
                <td>$A_{para} = \pi_0 + \pi_1 = 1 - \pi_2$</td>
            </tr>
        </tbody>
    </table>

    <!-- MINI EXERCISE 2 -->
    <div class="exercise">
        <h4>‚ö° Mini-Exercice 2 : S√©rie ou Parall√®le ?</h4>
        <p>Votre syst√®me est une centrale √©lectrique avec 2 g√©n√©rateurs. Il suffit d'un seul g√©n√©rateur pour alimenter la ville. Quel indicateur devez-vous minimiser pour √©viter le black-out ?</p>
        
        <button class="exercise-btn" onclick="toggleSolution('sol-2')">Voir la r√©ponse</button>
        
        <div id="sol-2" class="solution">
            <p>C'est un syst√®me en <strong>Parall√®le</strong>.</p>
            <p>Le black-out correspond √† l'arr√™t total (√âtat 2). Vous devez minimiser <strong>$\pi_2$</strong> (Indisponibilit√©).</p>
            <p>Si c'√©tait un syst√®me s√©rie (ex: 2 c√¢bles bout √† bout), il faudrait minimiser $\pi_1 + \pi_2$.</p>
        </div>
    </div>

    <hr>

    <!-- ================= SECTION 4: CORRIG√âS ================= -->
    <h2>4. Corrig√©s des Travaux Dirig√©s</h2>
    
    <p>Voici l'√©tude comparative compl√®te int√©gr√©e √©tape par √©tape.</p>

    <h3>Exercice : Comparaison d'impact (1 vs 2 R√©parateurs)</h3>
    <p><strong>√ânonc√© :</strong> Calculez et comparez l'indisponibilit√© ($\pi_2$) d'un syst√®me redondant (parall√®le) pour les deux cas de maintenance.</p>

    <div class="box" style="border-color: #6610f2; background: #f3f0ff;">
        <h4>üìã Solution D√©taill√©e</h4>
        
        <p>Nous utilisons les √©quations de balance locale (Coupes) : Flux Sortant = Flux Entrant.</p>

        <table>
            <thead>
                <tr>
                    <th>√âtape</th>
                    <th>Cas A : 2 R√©parateurs</th>
                    <th>Cas B : 1 R√©parateur</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>Coupe 0-1</strong></td>
                    <td>$2\lambda \pi_0 = \mu \pi_1 \Rightarrow \pi_1 = 2\rho \pi_0$</td>
                    <td>$2\lambda \pi_0 = \mu \pi_1 \Rightarrow \pi_1 = 2\rho \pi_0$</td>
                </tr>
                <tr>
                    <td><strong>Coupe 1-2</strong></td>
                    <td>$\lambda \pi_1 = \mathbf{2\mu} \pi_2 \Rightarrow \pi_2 = \frac{\lambda}{2\mu}\pi_1$</td>
                    <td>$\lambda \pi_1 = \mathbf{\mu} \pi_2 \Rightarrow \pi_2 = \frac{\lambda}{\mu}\pi_1$</td>
                </tr>
                <tr>
                    <td><strong>$\pi_2$ en fct de $\pi_0$</strong></td>
                    <td>$\pi_2 = \rho^2 \pi_0$</td>
                    <td>$\pi_2 = 2\rho^2 \pi_0$</td>
                </tr>
                <tr>
                    <td><strong>Normalisation</strong><br>($\sum \pi_i = 1$)</td>
                    <td>$\pi_0 (1 + 2\rho + \rho^2) = 1$<br>$\pi_0 (1+\rho)^2 = 1$</td>
                    <td>$\pi_0 (1 + 2\rho + 2\rho^2) = 1$<br>Pas de simplification quadratique</td>
                </tr>
                <tr>
                    <td><strong>Indisponibilit√©</strong><br>($U = \pi_2$)</td>
                    <td>$$ U_A = \frac{\rho^2}{(1+\rho)^2} $$</td>
                    <td>$$ U_B = \frac{2\rho^2}{1 + 2\rho + 2\rho^2} $$</td>
                </tr>
            </tbody>
        </table>

        <p><strong>Conclusion :</strong> Pour $\rho$ petit (r√©paration rapide), $U_B \approx 2 U_A$. Avoir un seul r√©parateur <strong>double</strong> quasiment le temps d'indisponibilit√© du syst√®me par rapport √† deux r√©parateurs.</p>
    </div>

</div>

<!-- ================= SCRIPTS ================= -->

<script type="module">
    // Import Viz.js for DOT rendering
    import { instance } from "https://unpkg.com/@viz-js/viz@3.2.0/lib/viz-standalone.mjs";

    // Function to render DOT graphs
    async function renderAllGraphs() {
        try {
            const viz = await instance();
            
            // Render Graph 1 (2 Rep)
            const code2 = document.getElementById('code-2rep').textContent;
            const svg2 = viz.renderString(code2, { engine: 'dot', format: 'svg' });
            document.getElementById('graph-2rep').innerHTML = svg2;

            // Render Graph 2 (1 Rep)
            const code1 = document.getElementById('code-1rep').textContent;
            const svg1 = viz.renderString(code1, { engine: 'dot', format: 'svg' });
            document.getElementById('graph-1rep').innerHTML = svg1;

        } catch (err) {
            console.error("Graph rendering error:", err);
            document.querySelectorAll('.graph-container').forEach(el => {
                el.innerHTML = `<p style="color:red">Erreur de rendu graphique: ${err.message}</p>`;
            });
        }
    }

    // Run on load
    renderAllGraphs();
</script>

<script>
    // Function to toggle solutions
    function toggleSolution(id) {
        const el = document.getElementById(id);
        if (el.style.display === "block") {
            el.style.display = "none";
        } else {
            el.style.display = "block";
        }
    }
</script>

</body>
</html>