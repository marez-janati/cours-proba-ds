<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chapitre 12 : Synth√®se et Probl√®mes d'Examen</title>
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700&family=Fira+Code:wght@400&display=swap" rel="stylesheet">

    <!-- MathJax Configuration -->
    <script>
    window.MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']],
        displayMath: [['$$', '$$'], ['\\[', '\\]']]
      },
      svg: {
        fontCache: 'global'
      }
    };
    </script>
    <script type="text/javascript" id="MathJax-script" async
      src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
    </script>

    <style>
        :root {
            --primary: #2c3e50;
            --accent: #3498db;
            --success: #27ae60;
            --warning: #f39c12;
            --bg-color: #f4f7f6;
            --card-bg: #ffffff;
        }

        body {
            font-family: 'Roboto', sans-serif;
            line-height: 1.6;
            background-color: var(--bg-color);
            color: #333;
            margin: 0;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
        }

        h1 {
            text-align: center;
            color: var(--primary);
            margin-bottom: 40px;
            border-bottom: 3px solid var(--accent);
            display: inline-block;
            padding-bottom: 10px;
        }

        /* --- PROBLEM CARD STYLING --- */
        .problem-card {
            background: var(--card-bg);
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            margin-bottom: 40px;
            overflow: hidden;
            border-top: 5px solid var(--primary);
        }

        .card-header {
            padding: 25px;
            border-bottom: 1px solid #eee;
        }

        .card-header h2 {
            margin-top: 0;
            color: var(--primary);
            font-size: 1.5rem;
        }

        .problem-statement {
            background-color: #e8f4fd;
            padding: 15px;
            border-radius: 8px;
            border-left: 5px solid var(--accent);
            margin-bottom: 20px;
        }

        .question-list {
            list-style: none;
            padding: 0;
        }

        .question-list li {
            background: #f9f9f9;
            margin: 10px 0;
            padding: 15px;
            border-radius: 5px;
            border: 1px solid #eee;
            display: flex;
            align-items: flex-start;
        }

        .question-badge {
            background: var(--primary);
            color: white;
            padding: 2px 8px;
            border-radius: 4px;
            font-weight: bold;
            margin-right: 15px;
            font-size: 0.9em;
            min-width: 25px;
            text-align: center;
        }

        /* --- GRAPHICS --- */
        .graph-container {
            text-align: center;
            margin: 20px auto;
            min-height: 180px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        /* --- INTERACTION --- */
        .interaction-area {
            text-align: center;
            padding: 20px;
            background: #f1f1f1;
            border-top: 1px solid #ddd;
        }

        .toggle-btn {
            background-color: var(--accent);
            color: white;
            border: none;
            padding: 12px 30px;
            font-size: 16px;
            border-radius: 30px;
            cursor: pointer;
            transition: transform 0.2s, background 0.2s;
            box-shadow: 0 4px 6px rgba(52, 152, 219, 0.3);
        }

        .toggle-btn:hover {
            background-color: #2980b9;
            transform: translateY(-2px);
        }

        /* --- SOLUTION SECTION (HIDDEN INITIALLY) --- */
        .solution-section {
            display: none; /* Hidden by default */
            padding: 30px;
            background-color: #fff;
            border-top: 2px dashed #ccc;
            animation: fadeIn 0.5s ease-in-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .solution-title {
            color: var(--success);
            font-weight: bold;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
        }
        .solution-title::before {
            content: "‚úì";
            margin-right: 10px;
            font-size: 1.5em;
        }

        /* Educational Boxes inside solution */
        .box {
            border-radius: 5px;
            padding: 15px;
            margin: 15px 0;
            border-left: 4px solid;
            font-size: 0.95rem;
        }
        .vigilance { background: #fff3cd; border-color: var(--warning); }
        .theory { background: #d4edda; border-color: var(--success); }
        .math-block { background: #f8f9fa; border: 1px solid #e9ecef; padding: 15px; border-radius: 5px; }

    </style>
</head>
<body>

<div class="container">
    <div style="text-align: center;">
        <h1>Synth√®se & Probl√®mes d'Examen</h1>
        <p style="max-width: 600px; margin: 0 auto 40px auto; color: #666;">
            Essayez de r√©soudre chaque probl√®me avant de r√©v√©ler la correction. 
            Ces exercices couvrent le param√©trage probabiliste, les matrices infinies et les propri√©t√©s matricielles.
        </p>
    </div>

    <!-- =========================================
         PROBLEM 1: THE ROBOT
         ========================================= -->
    <div class="problem-card">
        <div class="card-header">
            <h2>Probl√®me 1 : La Marche Al√©atoire du Robot</h2>
            
            <div class="problem-statement">
                <strong>√ânonc√© :</strong> Un robot se d√©place sur 3 secteurs circulaires (1, 2, 3).
                <ul>
                    <li>Avec probabilit√© $p$ : Il va dans le sens horaire ($i \to i+1$).</li>
                    <li>Avec probabilit√© $1-p$ : Il va dans le sens antihoraire ($i \to i-1$).</li>
                </ul>
            </div>

            <!-- Graph is visible immediately to help visualize -->
            <div id="graph-robot" class="graph-container">Chargement du diagramme...</div>

            <h3>Questions :</h3>
            <ul class="question-list">
                <li>
                    <span class="question-badge">Q1</span>
                    <div>√âcrivez la matrice de transition $P$ de ce syst√®me.</div>
                </li>
                <li>
                    <span class="question-badge">Q2</span>
                    <div>
                        Analysez la nature de la cha√Æne (Irr√©ductibilit√©, P√©riodicit√©) selon les valeurs de $p$.
                        <br><small><em>Indice : Que se passe-t-il si $p=1$ ?</em></small>
                    </div>
                </li>
                <li>
                    <span class="question-badge">Q3</span>
                    <div>
                        Si $p = 0.5$, calculez intuitivement et math√©matiquement la probabilit√© stationnaire $\pi_2$ (probabilit√© d'√™tre dans le secteur 2 √† long terme).
                    </div>
                </li>
            </ul>
        </div>

        <div class="interaction-area">
            <button class="toggle-btn" onclick="toggleSolution('sol-1', this)">Voir la Correction</button>
        </div>

        <div id="sol-1" class="solution-section">
            <h3 class="solution-title">Correction D√©taill√©e</h3>

            <h4>1. Matrice de Transition</h4>
            <div class="math-block">
                $$
                P = \begin{pmatrix}
                0 & p & 1-p \\
                1-p & 0 & p \\
                p & 1-p & 0
                \end{pmatrix}
                $$
            </div>

            <h4>2. Analyse de l'Ergodicit√© (Cas limites)</h4>
            <div class="vigilance">
                <strong>‚ö†Ô∏è Point de Vigilance :</strong>
                <ul>
                    <li>Si $p \in ]0, 1[$ : La cha√Æne est <strong>Ergodique</strong> (Irr√©ductible + Ap√©riodique). Elle converge vers une limite unique.</li>
                    <li>Si $p = 1$ ou $p = 0$ : La cha√Æne devient d√©terministe et <strong>P√©riodique</strong> (p√©riode $d=3$). Elle tourne en rond ind√©finiment sans converger vers une distribution stable au sens strict.</li>
                </ul>
            </div>

            <h4>3. R√©solution pour $p=0.5$</h4>
            <p>
                <strong>Intuition :</strong> Le syst√®me est parfaitement sym√©trique. Le robot n'a aucune pr√©f√©rence pour un secteur. Donc $\pi = (1/3, 1/3, 1/3)$.
            </p>
            <p><strong>Preuve Math√©matique :</strong> On r√©sout $\pi = \pi P$.</p>
            <div class="math-block">
                $$ \pi_1 = (1-p)\pi_2 + p\pi_3 $$
                Si on suppose la sym√©trie $\pi_1 = \pi_2 = \pi_3 = x$ :
                $$ x = (1-p)x + px \implies x = x(1) $$
                Cette √©quation est toujours vraie. Avec la condition de normalisation $\sum \pi_i = 1$, on a $3x=1 \implies x=1/3$.
            </div>
        </div>
    </div>

    <!-- =========================================
         PROBLEM 2: INFINITE MATRIX
         ========================================= -->
    <div class="problem-card">
        <div class="card-header">
            <h2>Probl√®me 2 : Matrices Infinies & Paradoxes</h2>
            
            <div class="problem-statement">
                <strong>√ânonc√© :</strong> On consid√®re un espace d'√©tats infini $S = \{0, 1, 2, \dots\}$.
                <ul>
                    <li><strong>Depuis 0 :</strong> On saute vers $j$ avec probabilit√© $P_{0j} = \frac{1}{(j+1)(j+2)}$.</li>
                    <li><strong>Depuis $j \ge 1$ :</strong> Retour d√©terministe vers 0 pas √† pas ($j \to j-1$).</li>
                </ul>
            </div>

            <div id="graph-infinite" class="graph-container">Chargement...</div>

            <h3>Questions :</h3>
            <ul class="question-list">
                <li>
                    <span class="question-badge">Q1</span>
                    <div>En √©crivant les √©quations de balance, montrez que $\pi_k = \frac{\pi_0}{k+1}$.</div>
                </li>
                <li>
                    <span class="question-badge">Q2</span>
                    <div>
                        Essayez de calculer la somme $\sum_{k=0}^{\infty} \pi_k$. Que remarquez-vous concernant la s√©rie harmonique ?
                    </div>
                </li>
                <li>
                    <span class="question-badge">Q3</span>
                    <div>Concluez sur la nature de la cha√Æne (R√©currence Positive ou Nulle ?).</div>
                </li>
            </ul>
        </div>

        <div class="interaction-area">
            <button class="toggle-btn" onclick="toggleSolution('sol-2', this)">Voir la Correction</button>
        </div>

        <div id="sol-2" class="solution-section">
            <h3 class="solution-title">Correction D√©taill√©e</h3>

            <h4>1. Calcul des sommes (S√©rie T√©lescopique)</h4>
            <p>On calcule la probabilit√© cumul√©e de quitter 0 pour aller "loin" :</p>
            <div class="math-block">
                On utilise la d√©composition : $\frac{1}{(j+1)(j+2)} = \frac{1}{j+1} - \frac{1}{j+2}$
                <br>
                Cela m√®ne √† la relation : $\pi_k = \frac{\pi_0}{k+1}$.
            </div>

            <h4>2. Le Paradoxe de la Normalisation</h4>
            <p>Pour qu'une distribution stationnaire existe, la somme des probabilit√©s doit valoir 1.</p>
            <div class="math-block">
                $$ \sum_{k=0}^{\infty} \pi_k = \sum_{k=0}^{\infty} \frac{\pi_0}{k+1} = \pi_0 \underbrace{\sum_{n=1}^{\infty} \frac{1}{n}}_{\text{S√©rie Harmonique}} $$
            </div>
            <div class="vigilance">
                Or, la s√©rie harmonique <strong>diverge</strong> vers $+\infty$.
                $$ \pi_0 \times \infty = 1 $$
            </div>

            <h4>3. Conclusion</h4>
            <p>
                La seule solution math√©matique possible est $\pi_0 = 0$, ce qui implique $\pi_k = 0$ pour tout $k$.
                <br><br>
                <strong>Interpr√©tation physique :</strong> La cha√Æne est <strong>R√©currente Nulle</strong>. Bien que le syst√®me revienne toujours √† l'√©tat 0 (probabilit√© 1), l'esp√©rance du temps de retour est infinie. La probabilit√© de trouver le syst√®me dans un √©tat pr√©cis √† un instant $t$ tend vers 0 quand $t \to \infty$.
            </p>
        </div>
    </div>

    <!-- =========================================
         PROBLEM 3: DOUBLY STOCHASTIC
         ========================================= -->
    <div class="problem-card">
        <div class="card-header">
            <h2>Probl√®me 3 : Matrices Doublement Stochastiques</h2>
            
            <div class="problem-statement">
                <strong>D√©finition :</strong> Une matrice est "Doublement Stochastique" si la somme de chaque ligne vaut 1 ET la somme de chaque colonne vaut 1.
            </div>

            <h3>Exercice :</h3>
            <div style="text-align: center; margin: 20px;">
                Soit la matrice $M$ :
                $$
                M = \begin{pmatrix}
                0.1 & 0.4 & 0.5 \\
                0.5 & 0.1 & 0.4 \\
                0.4 & 0.5 & 0.1
                \end{pmatrix}
                $$
            </div>
            <ul class="question-list">
                <li>
                    <span class="question-badge">Q1</span>
                    <div>V√©rifiez si cette matrice est doublement stochastique.</div>
                </li>
                <li>
                    <span class="question-badge">Q2</span>
                    <div>
                        Sans faire de calcul matriciel complexe ($\pi M = \pi$), donnez directement la distribution stationnaire $\pi$.
                    </div>
                </li>
            </ul>
        </div>

        <div class="interaction-area">
            <button class="toggle-btn" onclick="toggleSolution('sol-3', this)">Voir la Correction</button>
        </div>

        <div id="sol-3" class="solution-section">
            <h3 class="solution-title">Correction D√©taill√©e</h3>

            <div class="theory">
                <strong>üí° Th√©or√®me Fondamental :</strong>
                Si une matrice de transition $P$ (taille $N \times N$) est doublement stochastique et irr√©ductible, alors sa distribution stationnaire est <strong>toujours uniforme</strong> :
                $$ \pi = \left( \frac{1}{N}, \frac{1}{N}, \dots, \frac{1}{N} \right) $$
            </div>

            <h4>Application :</h4>
            <ol>
                <li><strong>V√©rification colonnes :</strong>
                    <ul>
                        <li>Col 1 : $0.1+0.5+0.4 = 1$</li>
                        <li>Col 2 : $0.4+0.1+0.5 = 1$</li>
                        <li>Col 3 : $0.5+0.4+0.1 = 1$</li>
                    </ul>
                    Elle est bien doublement stochastique.
                </li>
                <li><strong>R√©sultat :</strong>
                    La matrice est de taille $3 \times 3$.
                    $$ \pi = (1/3, 1/3, 1/3) $$
                </li>
            </ol>
        </div>
    </div>

</div>

<!-- SCRIPTS -->
<script type="module">
    // Import Viz.js
    import { instance } from "https://unpkg.com/@viz-js/viz@3.2.0/lib/viz-standalone.mjs";

    const robotDotCode = `digraph RobotWalk {
        layout=circo;
        rankdir=LR;
        node [shape=circle, style="filled", fillcolor="#e8f4fd", fontname="Roboto", fontsize=12, fixedsize=true, width=1.2, penwidth=2, color="#2c3e50"];
        edge [fontname="Roboto", fontsize=10, penwidth=1.5];
        1 [label="Secteur 1"]; 2 [label="Secteur 2"]; 3 [label="Secteur 3"];
        1 -> 2 [label="p", color="#3498db", fontcolor="#3498db"];
        2 -> 3 [label="p", color="#3498db", fontcolor="#3498db"];
        3 -> 1 [label="p", color="#3498db", fontcolor="#3498db"];
        1 -> 3 [label="1-p", color="#e74c3c", fontcolor="#e74c3c"];
        3 -> 2 [label="1-p", color="#e74c3c", fontcolor="#e74c3c"];
        2 -> 1 [label="1-p", color="#e74c3c", fontcolor="#e74c3c"];
    }`;

    const infiniteDotCode = `digraph InfiniteChain {
        rankdir=LR;
        bgcolor="transparent";
        node [shape=circle, style=filled, fillcolor="white", fontname="Roboto", color="#2c3e50"];
        edge [fontname="Roboto", fontsize=10];
        0 [label="0", fillcolor="#fff3cd", penwidth=2];
        1 [label="1"]; 2 [label="2"]; 3 [label="3"];
        inf [label="...", shape=none, style=none];
        {rank=same; 0; 1; 2; 3; inf}
        1 -> 0 [label="1", weight=2];
        2 -> 1 [label="1", weight=2];
        3 -> 2 [label="1", weight=2];
        inf -> 3 [label="1", style=dashed, weight=2];
        0 -> 0 [label="1/2", dir=back]; 
        0 -> 1 [label="1/6", constraint=false, color="#3498db", fontcolor="#3498db"];
        0 -> 2 [label="1/12", constraint=false, color="#3498db", fontcolor="#3498db"];
        0 -> 3 [label="1/20", constraint=false, color="#3498db", fontcolor="#3498db"];
    }`;

    async function renderGraphs() {
        try {
            const viz = await instance();
            document.getElementById('graph-robot').innerHTML = viz.renderString(robotDotCode, { engine: 'circo', format: 'svg' });
            document.getElementById('graph-infinite').innerHTML = viz.renderString(infiniteDotCode, { engine: 'dot', format: 'svg' });
        } catch (err) {
            console.error(err);
        }
    }
    renderGraphs();
</script>

<script>
    function toggleSolution(id, btn) {
        var x = document.getElementById(id);
        if (x.style.display === "block") {
            x.style.display = "none";
            btn.innerText = "Voir la Correction";
            btn.style.backgroundColor = "var(--accent)";
        } else {
            x.style.display = "block";
            btn.innerText = "Masquer la Correction";
            btn.style.backgroundColor = "#7f8c8d"; // Grey out button when open
        }
    }
</script>

</body>
</html>
